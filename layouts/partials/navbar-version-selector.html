{{ if .Site.Params.versions }}
<a class="nav-link dropdown-toggle" href="#" id="navbarDropdown" role="button" data-bs-toggle="dropdown" aria-haspopup="true" aria-expanded="false">
  {{ .Site.Params.version_menu }}
</a>
<div class="dropdown-menu dropdown-menu-right" aria-labelledby="navbarDropdown">
  {{ range .Site.Params.versions }}
  <!-- Debug output -->
  {{ if $.Site.Params.version_menu_pagelinks }}
    {{ if eq $.Site.Params.version_menu_pagelinks true }}
      {{ if $.Page.RelPermalink }}
        Current path: {{ $.Page.RelPermalink }}<br>
        {{ $currentPath := $.Page.RelPermalink }}
        {{ if hasPrefix $currentPath "/hugo-docsy-test/docs/" }}
          {{ $pathAfterDocs := strings.TrimPrefix "/hugo-docsy-test/docs/" $currentPath }}
          Path after /hugo-docsy-test/docs/: {{ $pathAfterDocs }}<br>
          {{ $baseURL := "https://paigecalvert.github.io/hugo-docsy-test" }}
          Base URL: {{ $baseURL }}<br>
          {{ if eq .version "main" }}
            Final URL: {{ $baseURL }}/docs/{{ $pathAfterDocs }}<br>
          {{ else }}
            Final URL: {{ $baseURL }}/{{ .version }}/docs/{{ $pathAfterDocs }}<br>
          {{ end }}
        {{ end }}
      {{ end }}
    {{ end }}
  {{ end }}
  <!-- End debug output -->
  <a class="dropdown-item" href="{{ if $.Site.Params.version_menu_pagelinks }}{{ if eq $.Site.Params.version_menu_pagelinks true }}{{ if $.Page.RelPermalink }}{{ $currentPath := $.Page.RelPermalink }}{{ if hasPrefix $currentPath "/hugo-docsy-test/docs/" }}{{ $pathAfterDocs := strings.TrimPrefix "/hugo-docsy-test/docs/" $currentPath }}{{ $baseURL := "https://paigecalvert.github.io/hugo-docsy-test" }}{{ if eq .version "main" }}{{ $baseURL }}/docs/{{ $pathAfterDocs }}{{ else }}{{ $baseURL }}/{{ .version }}/docs/{{ $pathAfterDocs }}{{ end }}{{ else }}{{ .url }}{{ end }}{{ else }}{{ .url }}{{ end }}{{ else }}{{ .url }}{{ end }}{{ else }}{{ .url }}{{ end }}">{{ .version }}</a>
  {{ end }}
</div>
{{ end }} 